(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e5479cf"],{"1b62":function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return d}));a("d81d");var n=a("cdd9"),i={data:function(){return{isCollapse:!1,reSubmit:!1,loading:!1,opTitle:"",opType:"",opKey:1,opDialog:!1,clearFk:1,mulSelection:[]}},methods:{commonEdit:function(e){var t=this;this.opType="edit",this.modalData=e,this.opKey++,setTimeout((function(){t.opDialog=!0}),n["a"].modalTime)},commonAdd:function(){var e=this;this.opType="add",this.opKey++,setTimeout((function(){e.opDialog=!0}),n["a"].modalTime)},callbackModal:function(){this.fetchData()},onReset:function(){this.$refs["formData"].resetFields(),this.clearFk++},handleSelectionChange:function(e){this.mulSelection=e},preDeleteBatch:function(e){var t=[];this.mulSelection.map((function(a){t.push(a[e])})),this.handleDelete(t)},preDelete:function(e,t,a){a&&a.stopPropagation();var n=[e[t]];this.handleDelete(n)}}},r=a("5530"),s=a("f66f"),l=a("1a40"),o=a("5d85"),c=a("94d2"),u=a("2f62"),m=a("e350"),d={components:{tablePagination:s["a"],OperateButton:l["a"],baseForm:o["a"],colorWord:c["a"]},computed:Object(r["a"])({},u["c"]["userInfo"]),methods:{checkPerm:m["a"],checkUser:m["b"],handleDia:function(e){var t=this,a=e.row,n=void 0===a?{}:a,i=e.options,r=e.cb,s=e.nextTickCb;i=Object.assign(i,{visible:!0,currentFormValue:n}),r&&r(),this.$nextTick((function(){s&&s(),i.ref&&t.$refs[i.ref].clear()}))},handleValidate:function(e){var t=this,a=e.refname,n=e.cb;this.$nextTick((function(){t.$refs[a].handleFormValidate((function(e){n&&n(e)}))}))},isDo:function(e){var t=e.cb,a=e.title,n=e.catchcb,i=void 0===n?function(){}:n;this.$confirm(a,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(t).catch(i)},go:function(e){this.$router.push(e)},message:function(e,t){this.$message({message:t,type:e})}}}},"58de":function(e,t,a){"use strict";var n=a("a8ea"),i=a.n(n);i.a},"77e91":function(e,t,a){"use strict";a("4160"),a("c975"),a("ac1f"),a("1276"),a("159b");var n=a("b775"),i=a("51be"),r=i["a"],s={validCode:{url:r+"/api/topic/uniqueCheck",method:"get"},applicant:{url:r+"/api/userinfo/queryApplicants",method:"get"},getTopicsByClusterId:{url:r+"/api/topic/getTopicsByClusterId",method:"get"},getTopicsByCluster:{url:r+"/api/topic/getTopicsByCluster",method:"get"}},l={list:{url:r+"/api/env/listEnvironment",method:"get"}},o={list:{url:r+"/api/service/listClusters",method:"get"}},c={list:{url:r+"/api/consumer/queryApprovedConsumers",method:"get"},getApproveTopicList:{url:r+"/api/topic/getTopicsByClusterId",method:"get"},getConsumersByClusterId:{url:r+"/api/consumer/getConsumersByClusterId",method:"get"},validCode:{url:r+"/api/consumer/uniqueCheck",method:"post"}},u={theme:s,cluster:o,consumer:c,environment:l};function m(e){if(-1===e.indexOf("_"))return u[e];var t=u;return e.split("_").forEach((function(e){t=t[e]})),t}t["a"]={accessAPI:function(e){var t=e.apiUrl,a=void 0===t?"":t,i=e.params,r=void 0===i?{}:i,s=e.headers,l=void 0===s?{}:s,o={headers:l},c=m(a);return Object.assign(o,{url:c.url,method:c.method}),"get"===c.method?Object.assign(o,{params:r}):"post"!==c.method&&"put"!==c.method&&"patch"!==c.method&&"delete"!==c.method||Object.assign(o,{data:r}),Object(n["a"])(o)}}},9022:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-page detail-page"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.environment.loading,expression:"environment.loading"}],staticClass:"l-page__search"},[a("div",{staticClass:"content_breadcrumb "},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/theme/list"}}},[e._v(e._s("主题管理"))]),a("el-breadcrumb-item",[e._v(" "+e._s(e.topicName)+" ")])],1)],1),a("div",{staticClass:"title env"},[a("label",[e._v("环境 ：")]),a("el-select",e._b({staticClass:"l-page__env",attrs:{clearable:!1},model:{value:e.env,callback:function(t){e.env=t},expression:"env"}},"el-select",e.GLOBAL.select,!1),e._l(e.environment.list,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{name:"first"}},[a("span",{attrs:{slot:"label"},slot:"label"},[e._v("主题详情")]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.detail.loading,expression:"detail.loading"}],staticClass:"l-pane-content"},["rocketmq"===e.detail.type?a("theme-detail-rocketmq",{attrs:{result:e.detail.result}}):e._e(),"kafka"===e.detail.type?a("theme-detail-kafka",{attrs:{result:e.detail.result}}):e._e()],1)]),a("el-tab-pane",{attrs:{label:"topic监控",name:"second"}},[a("theme-monitor",{attrs:{initflg:e.themeMonitor.flg,"topic-name":e.topicName,"env-id":e.env,"cluster-name":e.clusterName}})],1),a("el-tab-pane",{attrs:{label:"客户端监控",name:"third"}},[a("client-monitor",{attrs:{initflg:e.clientMonitor.flg,"topic-name":e.topicName,"env-id":e.env}})],1)],1)],1)])},i=[],r=(a("4de4"),a("d81d"),a("b0c0"),a("a9e3"),a("5530")),s=(a("96cf"),a("1da1")),l=a("12de"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-table-list"},[a("div",{staticClass:"l-table-box"},[a("h3",[e._v("主题详情")]),a("table-pagination",e._b({},"table-pagination",e.themeDetailTable,!1))],1),a("div",{staticClass:"l-table-box"},[a("h3",[e._v("消费组信息")]),a("table-pagination",e._b({},"table-pagination",e.consumerGroupTable,!1))],1)])},c=[],u=a("1b62"),m={name:"themeDetailRocketmq",mixins:[u["a"]],props:{result:Object},data:function(){return{themeDetailTable:{isPagination:!1,columns:[{type:"index",width:40},{prop:"brokerName",label:"Broker Name"},{prop:"qid",label:"QID"},{prop:"minOffset",label:"MinOffset"},{prop:"maxOffset",label:"MaxOffset"},{prop:"lastUpdated",label:"LastUpdate"}],data:[],loading:!1},consumerGroupTable:{isPagination:!1,columns:[{type:"index",width:40},{prop:"topic",label:"topic"},{prop:"consumerGroup",label:"consumerGroup"},{prop:"accumulation",label:"accumulation"},{prop:"inTPS",label:"inTPS"},{prop:"outTPS",label:"outTPS"},{prop:"inMsg24Hour",label:"inMsg24Hour"},{prop:"outMsg24Hour",label:"outMsg24Hour"}],data:[],loading:!1}}},watch:{result:{deep:!0,handler:function(){this.generateTableData()}}},created:function(){this.generateTableData()},methods:{generateTableData:function(){this.themeDetailTable.data=this.result.topicStatusDtoList,this.consumerGroupTable.data=this.result.statsAllResultDtoList}}},d=m,p=a("2877"),h=Object(p["a"])(d,o,c,!1,null,null,null),g=h.exports,f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-table-list"},[a("div",{staticClass:"l-table-box"},[a("h3",[e._v("主题详情")]),a("table-pagination",e._b({},"table-pagination",e.themeDetailTable,!1))],1),a("div",{staticClass:"l-table-box"},[a("h3",[e._v("消费组信息")]),a("table-pagination",e._b({},"table-pagination",e.consumerGroupTable,!1))],1),a("div",{staticClass:"l-table-box"},[a("h3",[e._v("主题配置信息")]),a("table-pagination",e._b({},"table-pagination",e.themeConfigTable,!1))],1)])},b=[],v={name:"themeDetailKafka",mixins:[u["a"]],props:{result:Object},data:function(){return{themeDetailTable:{isPagination:!1,columns:[{type:"index",width:40},{prop:"partition",label:"partition"},{prop:"offset",label:"offset"},{prop:"leader",label:"leader"},{prop:"isr",label:"isr"},{prop:"replicas",label:"replicas"}],data:[],loading:!1},consumerGroupTable:{isPagination:!1,columns:[{type:"index",width:40},{prop:"value",label:"consumer"}],data:[],loading:!1},themeConfigTable:{isPagination:!1,columns:[{type:"index",width:40},{prop:"object1",label:"key"},{prop:"object2",label:"value"}],data:[],loading:!1}}},watch:{result:{deep:!0,handler:function(){this.generateTableData()}}},created:function(){this.generateTableData()},methods:{generateTableData:function(){this.themeDetailTable.data=this.result.topicInfos,this.consumerGroupTable.data=this.result.consumers,this.themeConfigTable.data=this.result.topicConfigs}}},R=v,T=Object(p["a"])(R,f,b,!1,null,null,null),C=T.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.initflg?a("div",{staticClass:"l-chart-container"},[a("time-range",{on:{change:e.getTimeRange}}),a("chart",e._b({attrs:{loading:e.loading.topicTps,chartData:[e.topicTps]}},"chart",e.GLOBAL.chartConfig,!1)),a("chart",e._b({attrs:{loading:e.loading.dailyMsg,chartData:[e.dailyMsg]}},"chart",e.GLOBAL.chartConfig,!1))],1):e._e()},w=[],x=(a("4160"),a("159b"),a("d325")),O=a("ca00"),_=a("5da6"),k={name:"themeMonitor",components:{chart:x["a"],timeRange:_["a"]},props:{initflg:{type:Boolean,default:!1},topicName:String,clusterName:String,envId:[String,Number]},data:function(){return{topicTps:{title:"Topic发送tps",data:[],legend:[{name:"tps",attr:"tps"}]},dailyMsg:{title:"Topic日消息量",data:[],legend:[{name:"offsets daily increasement",attr:"offsets_daily_increasement"}]},loading:{topicTps:!1,dailyMsg:!1},time:[]}},watch:{time:function(){this.initflg&&this.loadData()},envId:function(){this.initflg&&this.time&&this.loadData()}},methods:{getTimeRange:function(e){this.time=e},loadData:function(){var e={topicName:this.topicName,clusterName:this.clusterName,beginTime:this.time[0],endTime:this.time[1],envId:this.envId};this.getTopicTps(e),this.getDailyMsg(e)},generateChartData:function(e){var t=[];return O["a"].dataSort(e).forEach((function(e){t.push({name:e.name,x:O["a"].timeToStr(1e3*e.timestamp,4),value:e.value})})),t},getTopicTps:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading.topicTps=!0,a.next=3,Object(l["t"])(e);case 3:n=a.sent,i=n.result,t.loading.topicTps=!1,t.topicTps.data=t.generateChartData(i);case 7:case"end":return a.stop()}}),a)})))()},getDailyMsg:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading.dailyMsg=!0,a.next=3,Object(l["s"])(e);case 3:n=a.sent,i=n.result,t.loading.dailyMsg=!1,t.dailyMsg.data=t.generateChartData(i);case 7:case"end":return a.stop()}}),a)})))()}}},y=k,j=Object(p["a"])(y,D,w,!1,null,null,null),I=j.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.initflg?a("div",{staticClass:"l-chart-container"},[a("time-range",{staticStyle:{float:"right"},on:{change:e.getTimeRange}}),a("div",{staticClass:"condition"},[a("label",[e._v("Client IP")]),a("el-select",e._b({attrs:{placeholder:"请选择"},on:{change:e.getClientData},model:{value:e.ip,callback:function(t){e.ip=t},expression:"ip"}},"el-select",e.GLOBAL.select,!1),e._l(e.clientIps,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("chart",e._b({attrs:{loading:e.loading.costRate,chartData:[e.costRate]}},"chart",e.GLOBAL.chartConfig,!1)),a("chart",e._b({attrs:{loading:e.loading.successRate,chartData:[e.successRate]}},"chart",e.GLOBAL.chartConfig,!1)),a("chart",e._b({attrs:{loading:e.loading.failRate,chartData:[e.failRate]}},"chart",e.GLOBAL.chartConfig,!1)),a("chart",e._b({attrs:{loading:e.loading.distributeRate,chartData:[e.distributeRate]}},"chart",e.GLOBAL.chartConfig,!1)),a("chart",e._b({attrs:{loading:e.loading.msgSize,chartData:[e.msgSize]}},"chart",e.GLOBAL.chartConfig,!1))],1):e._e()},S=[],M={name:"themeMonitor",components:{chart:x["a"],timeRange:_["a"]},props:{initflg:{type:Boolean,default:!1},topicName:String,envId:[String,Number]},data:function(){return{time:[],clientIps:[],ip:"",costRate:{title:"发送耗时指标",data:[],legend:[{name:"percent95",attr:"percent95"},{name:"percent999",attr:"percent999"}]},successRate:{title:"发送成功速率指标",data:[],legend:[{name:"mean",attr:"mean"},{name:"min1rate",attr:"min1rate"},{name:"min5rate",attr:"min5rate"},{name:"min15rate",attr:"min15rate"}]},failRate:{title:"发送失败速率指标",data:[],legend:[{name:"mean",attr:"mean"},{name:"min1rate",attr:"min1rate"},{name:"min5rate",attr:"min5rate"},{name:"min15rate",attr:"min15rate"}]},distributeRate:{title:"发送耗时分布（单位毫秒）",data:[],legend:[{name:"less1",attr:"less1"},{name:"less5",attr:"less5"},{name:"less10",attr:"less10"},{name:"less50",attr:"less50"},{name:"less100",attr:"less100"},{name:"less500",attr:"less500"},{name:"less1000",attr:"less1000"},{name:"more1000",attr:"more1000"}]},msgSize:{title:"发送消息体大小分布（单位KB）",data:[],legend:[{name:"less1",attr:"less1"},{name:"less5",attr:"less5"},{name:"less10",attr:"less10"},{name:"less50",attr:"less50"},{name:"less100",attr:"less100"},{name:"less500",attr:"less500"},{name:"less1000",attr:"less1000"},{name:"more1000",attr:"more1000"}]},loading:{costRate:!1,successRate:!1,failRate:!1,distributeRate:!1,msgSize:!1}}},watch:{time:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.initflg&&e.getIp();case 1:case"end":return t.stop()}}),t)})))()},envId:function(){this.time&&this.initflg&&this.getIp()}},methods:{getTimeRange:function(e){this.time=e},getClientData:function(e){this.ip=e,this.loadData()},getIp:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.costRate.data=[],e.successRate.data=[],e.failRate.data=[],e.clientIps=[],e.distributeRate.data=[],e.msgSize.data=[],a={clientName:e.topicName,beginTime:e.time[0],endTime:e.time[1],envId:e.envId},t.next=9,Object(l["n"])(a);case 9:n=t.sent,i=n.result,e.clientIps=i.map((function(e){return{label:e.value,value:e.value}})),0==e.clientIps.length?e.ip="":e.ip=e.clientIps[0].value,e.loadData();case 14:case"end":return t.stop()}}),t)})))()},loadData:function(){if(this.ip){var e={clientName:this.topicName,beginTime:this.time[0],endTime:this.time[1],ip:this.ip,envId:this.envId};this.getClientCostRate(e),this.getClientSuccessRate(e),this.getClientFailRate(e),this.getClientDistributeRate(e),this.getClientMsgSize(e)}},generateChartData:function(e){var t=[];return O["a"].dataSort(e).forEach((function(e){t.push({name:e.name,x:O["a"].timeToStr(1e3*e.timestamp,4),value:e.value})})),t},getClientCostRate:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading.costRate=!0,a.next=3,Object(l["c"])(e);case 3:n=a.sent,i=n.result,t.loading.costRate=!1,t.costRate.data=t.generateChartData(i);case 7:case"end":return a.stop()}}),a)})))()},getClientSuccessRate:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading.successRate=!0,a.next=3,Object(l["g"])(e);case 3:n=a.sent,i=n.result,t.loading.successRate=!1,t.successRate.data=t.generateChartData(i);case 7:case"end":return a.stop()}}),a)})))()},getClientFailRate:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading.failRate=!0,a.next=3,Object(l["e"])(e);case 3:n=a.sent,i=n.result,t.loading.failRate=!1,t.failRate.data=t.generateChartData(i);case 7:case"end":return a.stop()}}),a)})))()},getClientDistributeRate:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading.distributeRate=!0,a.next=3,Object(l["d"])(e);case 3:n=a.sent,i=n.result,t.loading.distributeRate=!1,t.distributeRate.data=t.generateChartData(i);case 7:case"end":return a.stop()}}),a)})))()},getClientMsgSize:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading.msgSize=!0,a.next=3,Object(l["f"])(e);case 3:n=a.sent,i=n.result,t.loading.msgSize=!1,t.msgSize.data=t.generateChartData(i);case 7:case"end":return a.stop()}}),a)})))()}}},B=M,L=Object(p["a"])(B,N,S,!1,null,null,null),A=L.exports,G={name:"themeDetail",components:{themeDetailRocketmq:g,themeDetailKafka:C,themeMonitor:I,clientMonitor:A},data:function(){return{activeName:"first",environment:{list:[],loading:!1},env:void 0,detail:{type:"",loading:!1,result:{}},topicName:"",clusterName:"",themeMonitor:{flg:!1},clientMonitor:{flg:!1}}},watch:{$route:function(){this.loadDetail()},env:function(e){this.loadThemeDetail(this.getId()),this.clusterName=this.environment.list.filter((function(t){return Number(t.value)===Number(e)}))[0].serverName}},created:function(){this.loadDetail()},methods:{viewDetail:function(){var e=this.getId();this.$router.push({name:"themeDetail",params:{id:e}})},loadDetail:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e.getId(),e.loadEnv(a);case 2:case"end":return t.stop()}}),t)})))()},getId:function(){var e=this.$route.params.id;return void 0===e?void this.$router.push({name:"themeList"}):e},loadEnv:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n,i,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.environment.loading=!0,a.next=3,Object(l["u"])({id:e});case 3:n=a.sent,i=n.result.records.filter((function(t){return Number(t.id)===Number(e)}))[0],s=i.environments,s=s.map((function(e){return Object(r["a"])(Object(r["a"])({},e),{},{label:e.environmentName,value:e.environmentId})})),t.topicName=i.name,t.environment.loading=!1,t.environment.list=s,t.env=s[0].value;case 11:case"end":return a.stop()}}),a)})))()},loadThemeDetail:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.detail.loading=!0,a.next=3,Object(l["o"])(e,{envId:t.env});case 3:n=a.sent,t.detail.loading=!1,t.detail.result=n.result,n.result.topicConfigs?t.detail.type="kafka":t.detail.type="rocketmq";case 7:case"end":return a.stop()}}),a)})))()},handleClick:function(e){"second"===e.name&&(this.themeMonitor.flg=!0),"third"===e.name&&(this.clientMonitor.flg=!0)}}},$=G,P=(a("58de"),Object(p["a"])($,n,i,!1,null,null,null));t["default"]=P.exports},a8ea:function(e,t,a){},e350:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));a("caad"),a("45fc"),a("2532");var n=a("4360"),i=function(e){if(e&&e instanceof Array&&e.length>0){var t=n["a"].getters&&n["a"].getters.permissions,a=e,i=t.some((function(e){return a.includes(e)}));return!!i}return console.error("need roles! Like v-if=\"checkPerm['op_editor']\""),!1},r=function(e){var t=n["a"].getters.userInfo.realName;return e===t}},ed08:function(e,t,a){"use strict";function n(e,t,a){var n,i,r,s,l,o=function o(){var c=+new Date-s;c<t&&c>0?n=setTimeout(o,t-c):(n=null,a||(l=e.apply(r,i),n||(r=i=null)))};return function(){for(var i=arguments.length,c=new Array(i),u=0;u<i;u++)c[u]=arguments[u];r=this,s=+new Date;var m=a&&!n;return n||(n=setTimeout(o,t)),m&&(l=e.apply(r,c),r=c=null),l}}a.d(t,"a",(function(){return n}))}}]);