(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7cfd592c"],{"1b62":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return d}));n("d81d");var a=n("cdd9"),r={data:function(){return{isCollapse:!1,reSubmit:!1,loading:!1,opTitle:"",opType:"",opKey:1,opDialog:!1,clearFk:1,mulSelection:[]}},methods:{commonEdit:function(e){var t=this;this.opType="edit",this.modalData=e,this.opKey++,setTimeout((function(){t.opDialog=!0}),a["a"].modalTime)},commonAdd:function(){var e=this;this.opType="add",this.opKey++,setTimeout((function(){e.opDialog=!0}),a["a"].modalTime)},callbackModal:function(){this.fetchData()},onReset:function(){this.$refs["formData"].resetFields(),this.clearFk++},handleSelectionChange:function(e){this.mulSelection=e},preDeleteBatch:function(e){var t=[];this.mulSelection.map((function(n){t.push(n[e])})),this.handleDelete(t)},preDelete:function(e,t,n){n&&n.stopPropagation();var a=[e[t]];this.handleDelete(a)}}},i=n("5530"),o=n("f66f"),s=n("1a40"),c=n("5d85"),l=n("94d2"),u=n("2f62"),p=n("e350"),d={components:{tablePagination:o["a"],OperateButton:s["a"],baseForm:c["a"],colorWord:l["a"]},computed:Object(i["a"])({},u["c"]["userInfo"]),methods:{checkPerm:p["a"],checkUser:p["b"],handleDia:function(e){var t=this,n=e.row,a=void 0===n?{}:n,r=e.options,i=e.cb,o=e.nextTickCb;r=Object.assign(r,{visible:!0,currentFormValue:a}),i&&i(),this.$nextTick((function(){o&&o(),r.ref&&t.$refs[r.ref].clear()}))},handleValidate:function(e){var t=this,n=e.refname,a=e.cb;this.$nextTick((function(){t.$refs[n].handleFormValidate((function(e){a&&a(e)}))}))},isDo:function(e){var t=e.cb,n=e.title,a=e.catchcb,r=void 0===a?function(){}:a;this.$confirm(n,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(t).catch(r)},go:function(e){this.$router.push(e)},message:function(e,t){this.$message({message:t,type:e})}}}},"2d9d":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"c-dialog"},[n("el-dialog",{directives:[{name:"drag-dialog",rawName:"v-drag-dialog"}],attrs:{title:e.modalTitle,visible:e.dialog,"before-close":e.closeHandle,width:e.width||"580px"},on:{"update:visible":function(t){e.dialog=t}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[e._t("default"),n("div",{staticClass:"c-dialog__footer",attrs:{slot:"footer"},slot:"footer"},[e._t("button"),e.noCancle?e._e():n("el-button",{attrs:{size:"mini"},on:{click:e.closeHandle}},[e._v("取消")])],2)],2)])],1)},r=[],i={props:["dialog","modalTitle","callback","refname","loading","width","noCancle"],methods:{closeHandle:function(){this.$emit("dealDialog")}}},o=i,s=n("2877"),c=Object(s["a"])(o,a,r,!1,null,null,null);t["a"]=c.exports},"52c7":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"l-page l-page--flex theme-application"},[n("div",{staticClass:"page-nav"},[e._v("主题管理")]),n("div",{staticClass:"l-page__content"},[n("div",{staticClass:"content--padding"},[n("div",{staticClass:"content__header"},[n("div",{staticStyle:{float:"left"}},[e._v(" 状态 "),n("el-select",e._b({attrs:{size:"mini"},on:{change:e.statusChange},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},"el-select",e.GLOBAL.select,!1),e._l(e.SearchStatus.options,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),n("el-input",{staticStyle:{"margin-left":"10px",width:"300px"},attrs:{size:"mini",placeholder:"搜索  ( 主题 、申请人 )"},on:{change:e.searchMaintable},model:{value:e.keyWord,callback:function(t){e.keyWord=t},expression:"keyWord"}})],1),n("div",{staticStyle:{float:"right"}},[n("el-button",e._b({attrs:{icon:"el-icon-circle-plus"},on:{click:e.operateOpen}},"el-button",e.GLOBAL.button,!1),[e._v(" 新增 ")]),n("el-button",e._b({attrs:{type:"",icon:"el-icon-bell"},on:{click:e.handleSendMsg}},"el-button",e.GLOBAL.button,!1),[e._v(" 发消息 ")])],1)]),n("div",{staticClass:"content__body"},[n("table-pagination",e._b({attrs:{"data-handler":e.handleTableData},on:{changePage:e.pageHandler}},"table-pagination",e.maintable,!1),[n("template",{slot:"insert"},[n("el-table-column",{attrs:{label:"操作",fixed:"right",width:"55",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-dropdown",{attrs:{trigger:"click",size:"medium"}},[n("span",{staticClass:"el-dropdown-link"},[n("i",{staticClass:"el-icon-menu el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",[n("el-button",{attrs:{disabled:!(e.checkPerm(["admin"])||t.row.applicant===e.userInfo.realName),type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(n){return e.operateEdit(t.row)}}},[n("span",[e._v("编辑")])])],1),n("el-dropdown-item",[n("el-button",{attrs:{disabled:!(e.checkPerm(["admin"])||t.row.applicant===e.userInfo.realName),type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(n){return e.handleDelete(t.row)}}},[n("span",[e._v("删除")])])],1),n("el-dropdown-item",[n("el-button",{attrs:{disabled:!e.checkPerm(["admin"]),type:"text",size:"mini",icon:"el-icon-s-check"},on:{click:function(n){return e.approval(t.row)}}},[n("span",[e._v("审批")])])],1),n("el-dropdown-item",[n("el-button",{attrs:{disabled:!(e.checkPerm(["admin"])&&1===t.row.status),type:"text",size:"mini",icon:"el-icon-setting"},on:{click:function(n){return e.configure(t.row)}}},[n("span",[e._v("配置")])])],1),n("el-dropdown-item",[n("el-button",{attrs:{disabled:!(e.checkPerm(["admin"])&&1===t.row.status),type:"text",size:"mini",icon:"el-icon-sort"},on:{click:function(n){return e.handleSynchronization(t.row)}}},[n("span",[e._v("同步")])])],1)],1)],1)]}}])})],1),n("template",{slot:"insert2"},[n("el-table-column",e._b({attrs:{fixed:"left",label:"主题名",width:"250"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("color-word",{attrs:{type:"link",disabled:0===t.row.status||2===t.row.status},on:{click:function(n){return e.viewDetail(t.row)}}},[e._v(" "+e._s(t.row.name)+" ")])]}}])},"el-table-column",e.GLOBAL.column,!1))],1),n("template",{slot:"insert3"},[n("el-table-column",e._b({attrs:{label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{class:t.row.statusClass},[e._v(e._s(t.row.statusTxt))])]}}])},"el-table-column",e.GLOBAL.column,!1))],1),n("template",{slot:"insert4"},[n("el-table-column",e._b({attrs:{label:"环境",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.environments?n("div",{staticClass:"service-column"},e._l(t.row.environments,(function(a,r){return n("el-popover",{key:r,attrs:{placement:"right",width:"200",trigger:"hover"}},[n("el-card",{staticClass:"zms-host-card",attrs:{shadow:"never"}},e._l(t.row.environments,(function(t,a){return n("div",{key:a},[n("span",[e._v(e._s(t.environmentName+" : "))]),t.serverType?n("el-tooltip",{attrs:{content:t.serverType.toLowerCase(),placement:"top",effect:"light"}},[n("svg-icon",{attrs:{"icon-class":e.serviceIconClass(t.serverType)}})],1):e._e(),n("span",{staticClass:"card-item",on:{click:function(n){return e.goServiceDetail(t.serviceId,"state")}}},[e._v(" "+e._s(t.serverName)+" ")])],1)})),0),n("span",{staticClass:"content_envTxt",class:e.envType(a.environmentId),attrs:{slot:"reference"},slot:"reference"},[e._v(" "+e._s(a.environmentName)+" ")])],1)})),1):n("div",[e._v(e._s(e._f("isEmpty")(t.row.envTxt)))])]}}])},"el-table-column",e.GLOBAL.column,!1))],1)],2)],1)])]),n("op-freight",{attrs:{dialog:e.diaOptions.visible,modalTitle:e.diaOptions.diatitle[e.diaOptions.status],loading:e.diaOptions.loading},on:{dealDialog:e.closeDia}},[n("base-form",{ref:e.diaOptions.ref,attrs:{forms:e.diaOptions.forms,"current-form-value":e.diaOptions.currentFormValue,"label-width":"120px"}}),n("template",{slot:"button"},[n("el-button",e._b({on:{click:e.saveData}},"el-button",e.GLOBAL.button,!1),[e._v("保存")])],1)],2),n("op-freight",{attrs:{dialog:e.approvalOptions.visible,modalTitle:e.approvalOptions.diatitle,loading:e.approvalOptions.loading},on:{dealDialog:e.closeApprovalDia}},[n("base-form",{ref:e.approvalOptions.ref,attrs:{forms:e.approvalOptions.forms,"current-form-value":e.approvalOptions.currentFormValue,"label-width":"120px"}}),n("template",{slot:"button"},[n("el-button",e._b({on:{click:e.saveApprovalData}},"el-button",e.GLOBAL.button,!1),[e._v("保存")])],1)],2),n("op-freight",{attrs:{dialog:e.configOptions.visible,modalTitle:e.configOptions.diatitle,loading:e.configOptions.loading},on:{dealDialog:e.closeConfigDia}},[n("base-form",{ref:e.configOptions.ref,attrs:{forms:e.configOptions.forms,"current-form-value":e.configOptions.currentFormValue,"label-width":"120px"}}),n("template",{slot:"button"},[n("el-button",e._b({on:{click:e.saveConfigData}},"el-button",e.GLOBAL.button,!1),[e._v("保存")])],1)],2),n("op-freight",{attrs:{dialog:e.sendMsgOptions.visible,modalTitle:e.sendMsgOptions.diatitle,loading:e.sendMsgOptions.loading},on:{dealDialog:e.closeMsgDia}},[n("base-form",{ref:e.sendMsgOptions.ref,attrs:{forms:e.sendMsgOptions.forms,"current-form-value":e.sendMsgOptions.currentFormValue,"label-width":"120px"}}),n("template",{slot:"button"},[n("el-button",e._b({on:{click:e.saveMsgData}},"el-button",e.GLOBAL.button,!1),[e._v("保存")])],1)],2),n("op-freight",{attrs:{dialog:e.synchronizationOptions.visible,modalTitle:e.synchronizationOptions.diatitle,loading:e.synchronizationOptions.loading},on:{dealDialog:e.closeSynchronizationOptionsDia}},[n("base-form",{ref:e.synchronizationOptions.ref,attrs:{forms:e.synchronizationOptions.forms,"current-form-value":e.synchronizationOptions.currentFormValue,"label-width":"120px"}}),n("template",{slot:"button"},[n("el-button",e._b({on:{click:e.saveSynchronizationData}},"el-button",e.GLOBAL.button,!1),[e._v("保存")])],1)],2)],1)},r=[],i=(n("4de4"),n("4160"),n("c975"),n("a15b"),n("d81d"),n("b0c0"),n("b64b"),n("ac1f"),n("1276"),n("159b"),n("2909")),o=(n("96cf"),n("1da1")),s=n("5530"),c=n("2f62"),l=n("1b62"),u=n("12de"),p={data:function(){return{formData:{name:"",applicant:"",status:void 0},SearchCluster:{options:[],loading:!1},SearchTheme:{options:[],loading:!1},SearchApplicant:{options:[],loading:!1},SearchStatus:{options:[{label:"待审批",value:0},{label:"已审批",value:1}]}}},computed:{clusterName:function(){return this.formData.clusterName}},watch:{clusterName:function(){this.formData.name=""}},methods:{getClusterOptions:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.SearchCluster.loading=!0,t.next=3,Object(u["h"])();case 3:n=t.sent,n.result&&(e.SearchCluster.options=n.result.map((function(e){return Object(s["a"])({label:e.serverName,value:e.serverName},e)})),e.SearchCluster.loading=!1);case 5:case"end":return t.stop()}}),t)})))()},getThemeOptions:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.SearchTheme.loading=!0,n={clusterName:e.formData.clusterName},t.next=4,Object(u["r"])(n);case 4:a=t.sent,a.result&&(e.SearchTheme.options=a.result.map((function(e){return Object(s["a"])({label:e.name,value:e.name},e)}))),e.SearchTheme.loading=!1;case 7:case"end":return t.stop()}}),t)})))()},getApplicantOptions:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.SearchApplicant.loading=!0,t.next=3,Object(u["a"])();case 3:n=t.sent,n.result&&(e.SearchApplicant.options=n.result.map((function(e){return{label:e,value:e}}))),e.SearchApplicant.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},searchHandler:function(){var e=this;this.$refs.formData.validate((function(t){t&&e.loadTabledata(e.formData)}))}}},d=n("5a12"),m={data:function(){return{diaOptions:{visible:!1,ref:"diaform",status:0,diatitle:["新增","编辑"],forms:[{prop:"name",label:"主题名",checkApi:{apiUrl:"theme_validCode",message:"已存在或者以前使用过，请更换",paramkey:"name"},rules:[{required:!0,message:"请输入主题名",trigger:"blur"},{max:100,message:"小于100个字符",trigger:"blur"},{pattern:d["a"],message:"请输入数字、字母、下划线、中划线",trigger:"blur"}]},{prop:"applicant",label:"申请人",rules:[{required:!0,message:"申请人为必填项",trigger:"change"}]},{prop:"domain",label:"申请域(appId)",placeholder:"业务英文名字",rules:[{required:!0,message:"请输入申请域(appId)",trigger:"blur"}]},{prop:"environments",label:"环境选择",itemType:"checkbox",options:[],rules:[{required:!0,message:"请选择主题环境",trigger:"blur"}]},{prop:"tps",label:"发送速度",placeholder:"该topic最大发送速度",itemType:"number",slots:[{type:"append",text:"条/秒"}],min:0,step:500,defaultValue:1e3,stepStrictly:!0,rules:[{required:!0,message:"请输入发送速度"}]},{prop:"msgszie",label:"消息体",itemType:"number",min:0,step:512,defaultValue:1024,stepStrictly:!0,placeholder:"发送到topic最大消息",slots:[{type:"append",text:"字节"}],rules:[{required:!0,message:"请输入消息体"}]},{prop:"alertEmails",label:"邮箱通知列表",inputType:"textarea",placeholder:"示例：xx@zto.cn,aa@zto.cn",rules:[{required:!0,message:"请输入邮箱通知列表",trigger:"blur"},{pattern:d["c"],message:"请输入正确的邮箱，多个邮箱使用逗号【,】分隔",trigger:"blur"},{max:100,message:"最多输入100个字符",trigger:"blur"}]},{prop:"memo",label:"备注",inputType:"textarea",placeholder:"第一行：业务含义\n第二行：集群类型偏好Kafka还是RocketMQ",rules:[{required:!0,message:"请输入备注",trigger:"blur"},{max:100,message:"最多输入100个字符",trigger:"blur"}]}],currentFormValue:{},loading:!1}}},computed:Object(s["a"])({},Object(c["d"])({userInfo:function(e){return e.user.userInfo},envListData:function(e){return e.theme.envListData}})),methods:Object(s["a"])(Object(s["a"])({},Object(c["b"])({getEnvList:"theme/getEnvList"})),{},{operateEnvList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.envListData,e.diaOptions.loading=!0,void 0!==n){t.next=5;break}return t.next=5,e.getEnvList();case 5:e.diaOptions.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},operateOpen:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.operateEnvList();case 2:e.handleDia({options:e.diaOptions,cb:function(){e.diaOptions.status=0,Object.assign(e.diaOptions.forms[0],{disabled:!1}),Object.assign(e.diaOptions.forms[1],{defaultValue:e.userInfo.realName,disabled:!0,itemType:"input"}),Object.assign(e.diaOptions.forms[3],{disabled:!1,options:e.envListData.map((function(e){return Object(s["a"])({label:e.environmentName,value:e.id},e)})),defaultValue:e.envListData.map((function(e){return e.id}))})}});case 3:case"end":return t.stop()}}),t)})))()},operateEdit:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.operateEnvList();case 2:a=Object(s["a"])({},e),Array.isArray(a.environments)&&(a.environments=e.environments.map((function(e){return e.environmentId}))),t.handleDia({options:t.diaOptions,row:a,cb:function(){t.diaOptions.status=1,Object.assign(t.diaOptions.forms[1],{defaultValue:"",itemType:"remoteselect",apiUrl:"theme_applicant",disabled:!1});var e=!(0===a.status||2===a.status);Object.assign(t.diaOptions.forms[3],{disabled:!!e,options:t.envListData.map((function(e){return Object(s["a"])({label:e.environmentName,value:e.id},e)}))}),Object.assign(t.diaOptions.forms[0],{disabled:!!e})}});case 5:case"end":return n.stop()}}),n)})))()},closeDia:function(){Object.assign(this.diaOptions,{visible:!1})},saveData:function(){var e=this;this.handleValidate({refname:"diaform",cb:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(n){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=n.environments,n.environments=a.map((function(e){return{environmentId:e}})),e.diaOptions.loading=!0,0!==e.diaOptions.status){t.next=8;break}return t.next=6,Object(u["j"])(n);case 6:t.next=11;break;case 8:return r=e.diaOptions.currentFormValue.id,t.next=11,Object(u["l"])(r,n);case 11:e.diaOptions.loading=!1,e.message("success","保存成功"),e.closeDia(),e.loadTabledata();case 15:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()})}})},f=(n("99af"),n("a434"),{data:function(){return{forms:[{prop:"name",label:"主题名",disabled:!0},{prop:"partitions",label:"分片数",itemType:"number",min:1,max:64,rules:[{required:!0,message:"请输入分片数"}]},{prop:"replication",label:"副本数",itemType:"number",min:1,max:64,disabled:!1,rules:[{required:!0,message:"请输入kafka主题副本数"}]},{prop:"environments",label:"环境选择",itemType:"checkbox",options:[],rules:[{required:!0,message:"请选择主题环境",trigger:"blur"}],disabled:!0},{prop:"applicant",label:"申请人",disabled:!0,rules:[{required:!0,message:"申请人为必填项",trigger:"change"}]},{prop:"domain",label:"申请域(appId)",placeholder:"业务英文名字",disabled:!0,rules:[{required:!0,message:"请输入申请域(appId)",trigger:"blur"}]},{prop:"tps",label:"发送速度",placeholder:"该topic最大发送速度",itemType:"number",slots:[{type:"append",text:"条/秒"}],min:0,step:500,stepStrictly:!0,disabled:!0,rules:[{required:!0,message:"请输入发送速度"}]},{prop:"msgszie",label:"消息体",itemType:"number",min:0,step:512,stepStrictly:!0,placeholder:"发送到topic最大消息",disabled:!0,slots:[{type:"append",text:"字节"}],rules:[{required:!0,message:"请输入消息体"}]},{prop:"alertEmails",label:"邮箱通知列表",inputType:"textarea",placeholder:"示例：xx@zto.cn,aa@zto.cn",disabled:!0,rules:[{required:!0,message:"请输入邮箱通知列表",trigger:"blur"},{pattern:d["c"],message:"请输入正确的邮箱，多个邮箱使用逗号【,】分隔",trigger:"blur"},{max:100,message:"最多输入100个字符",trigger:"blur"}]},{prop:"memo",label:"备注",inputType:"textarea",disabled:!0,placeholder:"第一行：业务含义\n第二行：集群类型偏好Kafka还是RocketMQ",rules:[{required:!0,message:"请输入备注",trigger:"blur"},{max:100,message:"最多输入100个字符",trigger:"blur"}]}],approvalOptions:{visible:!1,ref:"approvalForm",diatitle:"主题审批",forms:[],currentFormValue:{},loading:!1}}},computed:Object(s["a"])({},Object(c["d"])({envListData:function(e){return e.theme.envListData}})),methods:Object(s["a"])(Object(s["a"])({},Object(c["b"])({getEnvList:"theme/getEnvList"})),{},{approvalEnvList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.envListData,e.approvalOptions.loading=!0,void 0!==n){t.next=5;break}return t.next=5,e.getEnvList();case 5:e.approvalOptions.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},approval:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var a,r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.approvalOptions.forms=Object(i["a"])(t.forms),n.next=3,t.approvalEnvList();case 3:r=Object(s["a"])({},e),r.environments=[],Array.isArray(e.environments)&&e.environments.forEach((function(e){r.environments.push(e.environmentId),r["cluster_"+e.environmentId]=e.serviceId})),o=r.environments.map((function(e){var n=t.envListData.filter((function(t){return t.id===e}))[0];return{prop:"cluster_"+e,label:n.environmentName+"集群",itemType:"remoteselect",apiUrl:"cluster_list",labelkeyname:"serverName",valuekeyname:"id",remoteParams:{envId:n.id},autoget:!0,selectInfo:t.changeCluserInfo,rules:[{required:!0,message:"请选择"+n.environmentName+"环境集群",trigger:"blur"}]}})),(a=t.approvalOptions.forms).splice.apply(a,[4,0].concat(Object(i["a"])(o))),t.handleDia({options:t.approvalOptions,row:r,cb:function(){Object.assign(t.approvalOptions.forms[3],{options:t.envListData.map((function(e){return Object(s["a"])({label:e.environmentName,value:e.id},e)}))}),Object.assign(t.approvalOptions.forms[2],{disabled:!(0===r.status||2===r.status)})}});case 9:case"end":return n.stop()}}),n)})))()},changeCluserInfo:function(e){e&&Object.assign(this.approvalOptions.forms[2],{disabled:"ROCKETMQ"===e.serverType})},closeApprovalDia:function(){Object.assign(this.approvalOptions,{visible:!1})},saveApprovalData:function(){var e=this;this.handleValidate({refname:"approvalForm",cb:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(n){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=n.environments,n.environments=a.map((function(e){var t=n["cluster_"+e];return delete n["cluster_"+e],{environmentId:e,serviceId:t}})),r=e.approvalOptions.currentFormValue.id,e.approvalOptions.loading=!0,t.next=6,Object(u["b"])(r,n);case 6:e.approvalOptions.loading=!1,e.message("success","审批成功"),e.closeApprovalDia(),e.loadTabledata();case 10:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()})}})}),v={data:function(){return{configForms:[{prop:"name",label:"主题名",disabled:!0,rules:[{required:!0,message:"请输入主题名",trigger:"blur"}]},{prop:"environments",label:"环境选择",itemType:"checkbox",options:[],rules:[{required:!0,message:"请选择主题环境",trigger:"blur"}],disabled:!0}],configOptions:{visible:!1,ref:"configForm",diatitle:"主题配置",forms:[],currentFormValue:{},loading:!1}}},computed:Object(s["a"])({},Object(c["d"])({envListData:function(e){return e.theme.envListData}})),methods:Object(s["a"])(Object(s["a"])({},Object(c["b"])({getEnvList:"theme/getEnvList"})),{},{configEnvList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.envListData,e.configOptions.loading=!0,void 0!==n){t.next=5;break}return t.next=5,e.getEnvList();case 5:e.configOptions.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},configure:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var a,r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.configOptions.forms=Object(i["a"])(t.configForms),n.next=3,t.configEnvList();case 3:r=Object(s["a"])({},e),r.environments=[],Array.isArray(r.environments)&&e.environments.forEach((function(e){r.environments.push(e.environmentId),r["cluster_"+e.environmentId]=e.gatedServiceId,r["clusterIp_"+e.environmentId]=e.gatedIps})),o=r.environments.map((function(e){var n=t.envListData.filter((function(t){return t.id===e}))[0];return[{prop:"cluster_"+e,label:n.environmentName+"灰度集群",itemType:"remoteselect",apiUrl:"cluster_list",remoteParams:{envId:e},labelkeyname:"serverName",valuekeyname:"id",autoget:!0,rules:[{required:!0,message:"请选择",trigger:"blur"}]},{prop:"clusterIp_"+e,label:n.environmentName+"灰度IP"}]})),t.configOptions.forms=(a=t.configOptions.forms).concat.apply(a,Object(i["a"])(o)),t.handleDia({options:t.configOptions,row:r,cb:function(){Object.assign(t.configOptions.forms[1],{options:t.envListData.map((function(e){return Object(s["a"])({label:e.environmentName,value:e.id},e)}))})}});case 9:case"end":return n.stop()}}),n)})))()},closeConfigDia:function(){Object.assign(this.configOptions,{visible:!1})},saveConfigData:function(){var e=this;this.handleValidate({refname:"configForm",cb:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(n){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=n.environments,n.environments=a.map((function(e){var t=n["cluster_"+e];delete n["cluster_"+e];var a=n["clusterIp_"+e];return delete n["clusterIp_"+e],{environmentId:e,gatedServiceId:t,gatedIps:a}})),r=e.configOptions.currentFormValue.id,e.configOptions.loading=!0,t.next=6,Object(u["i"])(r,{environments:n.environments});case 6:e.configOptions.loading=!1,e.message("success","配置成功"),e.closeConfigDia(),e.loadTabledata();case 10:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()})}})},g=n("e350"),b={data:function(){return{sendMsgOptions:{visible:!1,ref:"sendMsgForm",diatitle:"发消息",forms:[{prop:"envId",label:"环境",itemType:"select",options:[],change:this.changeEnvId,rules:[{required:!0,message:"请选择主题环境",trigger:"blur"}]},{prop:"topic",label:"主题",itemType:"select",options:[],rules:[{required:!0,message:"请选择主题",trigger:"blur"}]},{prop:"keys",label:"keys"},{prop:"tags",label:"tags"},{prop:"msg",label:"消息体",inputType:"textarea",rules:[{required:!0,message:"请输入消息体",trigger:"blur"}]}],loading:!1}}},methods:{changeEnvId:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.$refs.sendMsgForm.specialSet({prop:"topic",val:void 0}),a={envId:e},Object(g["a"])(["admin"])||(a.applicant=t.userInfo.realName),n.next=5,Object(u["r"])(a);case 5:if(r=n.sent,r.result){n.next=8;break}return n.abrupt("return");case 8:Object.assign(t.sendMsgOptions.forms[1],{options:r.result.map((function(e){return Object(s["a"])({label:e.name,value:e.name},e)}))});case 9:case"end":return n.stop()}}),n)})))()},msgEnvList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.envListData,e.sendMsgOptions.loading=!0,void 0!==n){t.next=5;break}return t.next=5,e.getEnvList();case 5:e.sendMsgOptions.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},handleSendMsg:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.msgEnvList();case 2:e.handleDia({options:e.sendMsgOptions,cb:function(){Object.assign(e.sendMsgOptions.forms[0],{options:e.envListData.map((function(e){return Object(s["a"])({label:e.environmentName,value:e.id},e)}))})}});case 3:case"end":return t.stop()}}),t)})))()},closeMsgDia:function(){Object.assign(this.sendMsgOptions,{visible:!1})},saveMsgData:function(){var e=this;this.handleValidate({refname:"sendMsgForm",cb:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.sendMsgOptions.loading=!0,t.next=3,Object(u["p"])(n);case 3:e.sendMsgOptions.loading=!1,e.message("success","发送成功"),e.closeMsgDia();case 6:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()})}}},h=n("2d9d"),O=n("ca00"),y={name:"themeList",mixins:[l["b"],l["a"],p,m,f,v,b],components:{OpFreight:h["a"]},data:function(){return{keyWord:"",status:"",maintable:{columns:[{type:"index",width:40,fixed:"left"},{prop:"applicant",label:"申请人",width:150},{prop:"alertEmails",label:"邮箱通知列表",width:250},{prop:"domain",label:"申请域(appId)",width:200},{prop:"tps",label:"发送速度",width:100},{prop:"msgszie",label:"消息体",width:100},{prop:"partitions",label:"分片数",width:80},{prop:"memo",label:"备注","min-width":300},{prop:"modifyDate",label:"修改时间",width:160}],data:[],insertNum:1,insertNum2:1,insertNum3:1,insertNum4:4,loading:!1,currentPage:1,pageSize:25,pagePagination:!0},synchronizationForms:[{prop:"environments",label:"环境",itemType:"checkbox",options:[]}],synchronizationOptions:{visible:!1,ref:"synchronizationForm",diatitle:"将主题同步到其他环境",forms:[],currentFormValue:{},loading:!1}}},computed:Object(s["a"])({},Object(c["d"])({envListData:function(e){return e.theme.envListData}})),created:function(){this.loadTabledata()},methods:Object(s["a"])(Object(s["a"])({goServiceDetail:function(e,t){this.$router.push({name:"serviceHome",params:{id:e,tab:t}})},pageHandler:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.assembleData(e);this.loadTabledata(t)},assembleData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.status=this.status,e.keyWord=this.keyWord,e},statusChange:function(e){this.status=e;var t=this.assembleData();this.loadTabledata(t)},searchMaintable:function(){var e=this.assembleData();this.loadTabledata(e)}},Object(c["b"])({getEnvList:"theme/getEnvList"})),{},{loadTabledata:function(){var e=arguments,t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.length>0&&void 0!==e[0]?e[0]:{},t.maintable.loading=!0,a.currentPage||(a.currentPage=t.maintable.currentPage,a.pageSize=t.maintable.pageSize),n.next=5,Object(u["u"])(a);case 5:r=n.sent,r.result&&(t.maintable.data=r.result.records,t.maintable.currentPage=r.result.currentPage,t.maintable.pageSize=r.result.pageSize,t.maintable.total=r.result.total,t.maintable.loading=!1);case 7:case"end":return n.stop()}}),n)})))()},handleTableData:function(e){var t=e.modifyDate,n=e.status,a=e.environments;return Object.assign(e,{statusTxt:0===n||2===n?"待审批":"已审批",statusClass:0===n||2===n?"wait":"done",modifyDate:O["a"].dateToStr(new Date(t),3),envTxt:a?a.map((function(e){return e.environmentName})).join(" "):""}),e},viewDetail:function(e){this.$router.push({name:"themeDetail",params:{id:e.id}})},handleDelete:function(e){var t=this;this.isDo({title:"是否确定是删除主题【".concat(e.name,"】？"),cb:function(){var n=Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.maintable.loading=!0,n.next=3,Object(u["k"])(e.id);case 3:t.message("success","删除成功"),t.loadTabledata();case 5:case"end":return n.stop()}}),n)})));function a(){return n.apply(this,arguments)}return a}()})},synchronizationEnvList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.envListData,e.synchronizationOptions.loading=!0,void 0!==n){t.next=5;break}return t.next=5,e.getEnvList();case 5:e.synchronizationOptions.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},handleSynchronization:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.synchronizationEnvList();case 2:a=Object(s["a"])({},e),Array.isArray(a.environments)&&(a.originEnvironments=O["a"].deepCopy(e.environments),a.environments=e.environments.map((function(e){return e.environmentId}))),t.synchronizationOptions.forms=Object(i["a"])(t.synchronizationForms),t.handleDia({options:t.synchronizationOptions,row:a,cb:function(){var e;Object.assign(t.synchronizationOptions.forms[0],{options:t.envListData.map((function(e){return Object(s["a"])({label:e.environmentName,value:e.id,disabled:a.environments.indexOf(e.id)>-1},e)})),change:t.setCluster});var n=t.envListData.map((function(e){var t=a.environments.indexOf(e.id);return t>-1?{prop:"originCluster_"+e.id,label:e.environmentName+"集群",defaultValue:a.originEnvironments[t].serverName,disabled:!0}:{prop:"cluster_"+e.id,label:e.environmentName+"集群",apiUrl:"cluster_list",itemType:"remoteselect",labelkeyname:"serverName",valuekeyname:"id",visible:!1,remoteParams:{envId:e.id},rules:[{required:!0,message:"请选择"}]}}));(e=t.synchronizationOptions.forms).push.apply(e,Object(i["a"])(n))}});case 6:case"end":return n.stop()}}),n)})))()},setCluster:function(e){var t=this,n=e.map((function(e){return"cluster_"+e})),a=this.synchronizationOptions.forms.map((function(e){return e.prop}));a.forEach((function(e,a){e.indexOf("cluster_")>-1&&(t.synchronizationOptions.forms[a].visible=!1,n.indexOf(e)>-1&&(t.synchronizationOptions.forms[a].visible=!0))}))},closeSynchronizationOptionsDia:function(){Object.assign(this.synchronizationOptions,{visible:!1})},saveSynchronizationData:function(){var e=this;this.handleValidate({refname:"synchronizationForm",cb:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(n){var a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=[],r=Object.keys(n).filter((function(e){return e.indexOf("cluster_")>-1})),!r.length){t.next=10;break}return r.map((function(e){var t=e.split("_")[1];a.push({environmentId:t,serviceId:n[e]})})),e.synchronizationOptions.loading=!0,i=e.synchronizationOptions.currentFormValue.id,t.next=8,Object(u["q"])(i,a);case 8:e.synchronizationOptions.loading=!1,e.loadTabledata();case 10:e.message("success","保存成功"),e.closeSynchronizationOptionsDia();case 12:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()})},envType:function(e){var t=e%5;switch(t){case 0:return"content_envTxt_color_0";case 1:return"content_envTxt_color_1";case 2:return"content_envTxt_color_2";case 3:return"content_envTxt_color_3";case 4:return"content_envTxt_color_4";default:return""}},serviceIconClass:function(e){switch(e){case"ZOOKEEPER":return"Zookeeper";case"INFLUXDB":return"influxDb";case"ZMS_ALERT":return"gaojing";case"ZMS_COLLECTOR":return"caiji";case"ROCKETMQ":return"RocketMQ";case"KAFKA":return"Kafka";case"ZMS_BACKUP_CLUSTER":return"backup";default:return""}}})},w=y,x=(n("a86e"),n("2877")),_=Object(x["a"])(w,a,r,!1,null,null,null);t["default"]=_.exports},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var a=n("1d80"),r=n("5899"),i="["+r+"]",o=RegExp("^"+i+i+"*"),s=RegExp(i+i+"*$"),c=function(e){return function(t){var n=String(a(t));return 1&e&&(n=n.replace(o,"")),2&e&&(n=n.replace(s,"")),n}};e.exports={start:c(1),end:c(2),trim:c(3)}},"5a12":function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));var a=function(e){var t=/^1[3|4|5|7|8][0-9]\d{8}$/;return t.test(e)},r=function(e,t,n){""===t||null===t||void 0===t||a(t)?n():n(new Error("请输入正确的11位手机号码"))},i=/^[A-Za-z0-9_-]+$/,o=/^((([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6}\,))*(([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})))$/},"5faa":function(e,t,n){},"77e91":function(e,t,n){"use strict";n("4160"),n("c975"),n("ac1f"),n("1276"),n("159b");var a=n("b775"),r=n("51be"),i=r["a"],o={validCode:{url:i+"/api/topic/uniqueCheck",method:"get"},applicant:{url:i+"/api/userinfo/queryApplicants",method:"get"},getTopicsByClusterId:{url:i+"/api/topic/getTopicsByClusterId",method:"get"},getTopicsByCluster:{url:i+"/api/topic/getTopicsByCluster",method:"get"}},s={list:{url:i+"/api/env/listEnvironment",method:"get"}},c={list:{url:i+"/api/service/listClusters",method:"get"}},l={list:{url:i+"/api/consumer/queryApprovedConsumers",method:"get"},getApproveTopicList:{url:i+"/api/topic/getTopicsByClusterId",method:"get"},getConsumersByClusterId:{url:i+"/api/consumer/getConsumersByClusterId",method:"get"},validCode:{url:i+"/api/consumer/uniqueCheck",method:"post"}},u={theme:o,cluster:c,consumer:l,environment:s};function p(e){if(-1===e.indexOf("_"))return u[e];var t=u;return e.split("_").forEach((function(e){t=t[e]})),t}t["a"]={accessAPI:function(e){var t=e.apiUrl,n=void 0===t?"":t,r=e.params,i=void 0===r?{}:r,o=e.headers,s=void 0===o?{}:o,c={headers:s},l=p(n);return Object.assign(c,{url:l.url,method:l.method}),"get"===l.method?Object.assign(c,{params:i}):"post"!==l.method&&"put"!==l.method&&"patch"!==l.method&&"delete"!==l.method||Object.assign(c,{data:i}),Object(a["a"])(c)}}},a15b:function(e,t,n){"use strict";var a=n("23e7"),r=n("44ad"),i=n("fc6a"),o=n("b301"),s=[].join,c=r!=Object,l=o("join",",");a({target:"Array",proto:!0,forced:c||l},{join:function(e){return s.call(i(this),void 0===e?",":e)}})},a623:function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").every,i=n("b301");a({target:"Array",proto:!0,forced:i("every")},{every:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},a86e:function(e,t,n){"use strict";var a=n("5faa"),r=n.n(a);r.a},a9e3:function(e,t,n){"use strict";var a=n("83ab"),r=n("da84"),i=n("94ca"),o=n("6eeb"),s=n("5135"),c=n("c6b6"),l=n("7156"),u=n("c04e"),p=n("d039"),d=n("7c73"),m=n("241c").f,f=n("06cf").f,v=n("9bf2").f,g=n("58a8").trim,b="Number",h=r[b],O=h.prototype,y=c(d(O))==b,w=function(e){var t,n,a,r,i,o,s,c,l=u(e,!1);if("string"==typeof l&&l.length>2)if(l=g(l),t=l.charCodeAt(0),43===t||45===t){if(n=l.charCodeAt(2),88===n||120===n)return NaN}else if(48===t){switch(l.charCodeAt(1)){case 66:case 98:a=2,r=49;break;case 79:case 111:a=8,r=55;break;default:return+l}for(i=l.slice(2),o=i.length,s=0;s<o;s++)if(c=i.charCodeAt(s),c<48||c>r)return NaN;return parseInt(i,a)}return+l};if(i(b,!h(" 0o1")||!h("0b1")||h("+0x1"))){for(var x,_=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof _&&(y?p((function(){O.valueOf.call(n)})):c(n)!=b)?l(new h(w(t)),n,_):w(t)},k=a?m(h):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),j=0;k.length>j;j++)s(h,x=k[j])&&!s(_,x)&&v(_,x,f(h,x));_.prototype=O,O.constructor=_,o(r,b,_)}},d81d:function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").map,i=n("1dde");a({target:"Array",proto:!0,forced:!i("map")},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},e350:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));n("caad"),n("45fc"),n("2532");var a=n("4360"),r=function(e){if(e&&e instanceof Array&&e.length>0){var t=a["a"].getters&&a["a"].getters.permissions,n=e,r=t.some((function(e){return n.includes(e)}));return!!r}return console.error("need roles! Like v-if=\"checkPerm['op_editor']\""),!1},i=function(e){var t=a["a"].getters.userInfo.realName;return e===t}}}]);