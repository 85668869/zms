(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d236ed5"],{"1b62":function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return p}));n("d81d");var r=n("cdd9"),a={data:function(){return{isCollapse:!1,reSubmit:!1,loading:!1,opTitle:"",opType:"",opKey:1,opDialog:!1,clearFk:1,mulSelection:[]}},methods:{commonEdit:function(e){var t=this;this.opType="edit",this.modalData=e,this.opKey++,setTimeout((function(){t.opDialog=!0}),r["a"].modalTime)},commonAdd:function(){var e=this;this.opType="add",this.opKey++,setTimeout((function(){e.opDialog=!0}),r["a"].modalTime)},callbackModal:function(){this.fetchData()},onReset:function(){this.$refs["formData"].resetFields(),this.clearFk++},handleSelectionChange:function(e){this.mulSelection=e},preDeleteBatch:function(e){var t=[];this.mulSelection.map((function(n){t.push(n[e])})),this.handleDelete(t)},preDelete:function(e,t,n){n&&n.stopPropagation();var r=[e[t]];this.handleDelete(r)}}},i=n("5530"),s=n("f66f"),c=n("1a40"),o=n("5d85"),u=n("94d2"),l=n("2f62"),d=n("e350"),p={components:{tablePagination:s["a"],OperateButton:c["a"],baseForm:o["a"],colorWord:u["a"]},computed:Object(i["a"])({},l["c"]["userInfo"]),methods:{checkPerm:d["a"],checkUser:d["b"],handleDia:function(e){var t=this,n=e.row,r=void 0===n?{}:n,a=e.options,i=e.cb,s=e.nextTickCb;a=Object.assign(a,{visible:!0,currentFormValue:r}),i&&i(),this.$nextTick((function(){s&&s(),a.ref&&t.$refs[a.ref].clear()}))},handleValidate:function(e){var t=this,n=e.refname,r=e.cb;this.$nextTick((function(){t.$refs[n].handleFormValidate((function(e){r&&r(e)}))}))},isDo:function(e){var t=e.cb,n=e.title,r=e.catchcb,a=void 0===r?function(){}:r;this.$confirm(n,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(t).catch(a)},go:function(e){this.$router.push(e)},message:function(e,t){this.$message({message:t,type:e})}}}},"22ce":function(e,t,n){"use strict";n.d(t,"k",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"l",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"n",(function(){return m})),n.d(t,"q",(function(){return f})),n.d(t,"g",(function(){return g})),n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return v})),n.d(t,"d",(function(){return b})),n.d(t,"p",(function(){return S})),n.d(t,"o",(function(){return T})),n.d(t,"m",(function(){return I})),n.d(t,"c",(function(){return C}));n("99af");var r=n("b775"),a=n("51be"),i=a["a"];function s(e){return Object(r["a"])({url:"".concat(i,"/api/service/queryHostServiceInstance"),method:"get",params:e})}function c(e){return Object(r["a"])({url:"".concat(i,"/api/service/getServiceAndEnvById"),method:"get",params:e})}function o(e){return Object(r["a"])({url:"".concat(i,"/api/service/deleteService/").concat(e),method:"delete"})}function u(e){return Object(r["a"])({url:"".concat(i,"/api/service/deleteServiceInstance/").concat(e),method:"delete"})}function l(e){return Object(r["a"])({url:"".concat(i,"/api/service/getServiceAndEnvByInstanceId"),method:"get",params:e})}function d(e,t){return Object(r["a"])({url:"".concat(i,"/api/service/").concat(e,"/rename"),method:"put",data:t})}function p(e){return Object(r["a"])({url:"".concat(i,"/api/service/getServiceInstanceConfig"),method:"get",params:e})}function m(e){return Object(r["a"])({url:"".concat(i,"/api/service/saveServiceInstanceConfig"),method:"post",data:e})}function f(e){return Object(r["a"])({url:"".concat(i,"/api/service/validServerName"),method:"get",params:e})}function g(e,t,n){return Object(r["a"])({url:"".concat(i,"/api/service/getAddServiceInstanceConfig/").concat(e,"/").concat(t,"/").concat(n),method:"get"})}function h(e){return Object(r["a"])({url:"".concat(i,"/api/service/addService"),method:"post",data:e})}function v(e){return Object(r["a"])({url:"".concat(i,"/api/service/addServiceInstance"),method:"post",data:e})}function b(e,t){return Object(r["a"])({url:"".concat(i,"/api/service/compareServiceProperty/").concat(e,"/").concat(t),method:"get"})}function S(e){return Object(r["a"])({url:"".concat(i,"/api/service/stopServiceInstance"),method:"post",data:e})}function T(e){return Object(r["a"])({url:"".concat(i,"/api/service/startServiceInstance"),method:"post",data:e})}function I(e){return Object(r["a"])({url:"".concat(i,"/api/service/restartServiceInstance"),method:"post",data:e})}function C(e){return Object(r["a"])({url:"".concat(i,"/api/service/listClusters"),method:"get",params:e})}},"44c6":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content_run_state"},["firstRun"==e.type?n("p",{staticClass:"content_header"},[e._v(e._s(e.headerTitle))]):e._e(),n("div",{staticClass:"content_state"},[n("span",[e._v("状态")]),0==e.runStatus?n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.runLoading,expression:"runLoading"}],staticClass:"content_icon",attrs:{"element-loading-text":e.loadingText,"element-loading-spinner":"el-icon-loading"}}):1==e.runStatus?n("b",{staticStyle:{"margin-left":"10px",color:"green"},attrs:{icon:"el-icon-date"}},[n("i",{staticClass:"el-icon-success"}),e._v(" 已完成 ")]):n("b",{staticStyle:{"margin-left":"10px",color:"red"}},[n("i",{staticClass:"el-icon-warning"}),e._v(" 失败 ")]),n("i",{staticClass:"el-icon-date",staticStyle:{"margin-left":"20px"}}),n("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.runTime))]),n("i",{staticClass:"el-icon-time",staticStyle:{"margin-left":"20px"}}),n("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.runningTimeStr))])]),n("div",{staticClass:"content_result"},e._l(e.runResult,(function(t){return n("el-collapse",{key:t.processId},[n("el-collapse-item",{class:e.processResultClass(t.status)},[n("template",{slot:"title"},[n("i",{class:"success"===e.processResultClass(t.status)?"el-icon-success":"el-icon-warning"}),e._v(" "+e._s(t.instanceName)+" ")]),n("el-tabs",{model:{value:e.logActiveName,callback:function(t){e.logActiveName=t},expression:"logActiveName"}},[t.stdoutLog?n("el-tab-pane",{attrs:{label:"stdout",name:"stdout"}},[n("div",{staticClass:"stdlog"},[e._v(" "+e._s(t.stdoutLog)+" ")])]):e._e(),t.stderrLog?n("el-tab-pane",{attrs:{label:"stderr",name:"stderr"}},[n("div",{staticClass:"stdlog"},[e._v(" "+e._s(t.stderrLog)+" ")])]):e._e()],1)],2)],1)})),1)])},a=[],i=(n("4de4"),n("4ec9"),n("d3b7"),n("3ca3"),n("ddb0"),n("96cf"),n("1da1")),s=n("b85c"),c=n("ca00"),o=(n("99af"),n("b775")),u=n("51be"),l=u["a"];function d(e){return Object(o["a"])({url:"".concat(l,"/api/process/").concat(e,"/getRunningStatus"),method:"get"})}function p(e,t){return Object(o["a"])({url:"".concat(l,"/api/process/").concat(e,"/tailProcessStderrLog"),method:"get",params:t})}function m(e,t){return Object(o["a"])({url:"".concat(l,"/api/process/").concat(e,"/tailProcessStdoutLog"),method:"get",params:t})}var f={name:"serviceRunState",props:{headerTitle:String,type:String,loadingText:String},data:function(){return{runningTimeStr:"0s",runningTimer:"",runningTime:0,runTime:"",runStatus:0,runLoading:!0,runResult:[],instanceParam:{},runningStatusTimer:"",processIds:[],logActiveName:"stdout"}},created:function(){var e=this;this.runTime=c["a"].getCurDateTime(),this.runningTimer=setInterval((function(){e.runningTime=e.runningTime+1,e.runningTimeStr=e.runningTime+"s"}),1e3)},beforeDestroy:function(){this.runningTimer&&clearInterval(this.runningTimer),this.runningStatusTimer&&clearInterval(this.runningStatusTimer)},methods:{checkProcessFailState:function(){this.runStatus=2,this.runLoading=!1,clearInterval(this.runningTimer)},checkProcessState:function(e){var t=this;if(e){this.instanceParam=new Map;var n,r=Object(s["a"])(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;this.processIds.push(a.processId),this.instanceParam.set(a.processId,a.instanceName+"（"+a.hostName+"）")}}catch(i){r.e(i)}finally{r.f()}this.runningStatusTimer=setInterval((function(){t.getProcessRunningStatus()}),2e3)}else this.checkProcessFailState()},getProcessRunningStatus:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.processIds.length<1)){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,d(e.processIds);case 4:if(n=t.sent,!n.result){t.next=22;break}r=Object(s["a"])(n.result),t.prev=7,i=regeneratorRuntime.mark((function t(){var n,r,i,s,c,o,u,l,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=a.value,"stop"!==e.type){t.next=5;break}"STOPPING"!==n.runningStatus&&"RUNNING"!==n.runningStatus&&(r=e.processIds.filter((function(e){return e!=n.id})),e.processIds=r,i="",s="","FATAL"===n.runningStatus&&(i=e.tailErrLog(n.id),s=e.tailOutLog(n.id)),c={processId:n.id,instanceName:e.instanceParam.get(n.id),status:"STOPPED"===n.runningStatus,stderrLog:i,stdoutLog:s},e.runResult.push(c)),t.next=19;break;case 5:if(("SUCCESS"!==n.status||"STARTING"===n.runningStatus||"STOPPED"===n.runningStatus)&&"FAILURE"!==n.status){t.next=19;break}if(o=e.processIds.filter((function(e){return e!=n.id})),e.processIds=o,u="",l="","SUCCESS"!==n.status){t.next=17;break}return t.next=13,e.tailErrLog(n.id);case 13:return u=t.sent,t.next=16,e.tailOutLog(n.id);case 16:l=t.sent;case 17:d={processId:n.id,instanceName:e.instanceParam.get(n.id),status:"RUNNING"===n.runningStatus,stderrLog:u,stdoutLog:l},e.runResult.push(d);case 19:case"end":return t.stop()}}),t)})),r.s();case 10:if((a=r.n()).done){t.next=14;break}return t.delegateYield(i(),"t0",12);case 12:t.next=10;break;case 14:t.next=19;break;case 16:t.prev=16,t.t1=t["catch"](7),r.e(t.t1);case 19:return t.prev=19,r.f(),t.finish(19);case 22:e.processIds.length<1&&(e.runStatus=1,e.runLoading=!1,clearInterval(e.runningStatusTimer),clearInterval(e.runningTimer),e.$emit("runComplete"));case 23:case"end":return t.stop()}}),t,null,[[7,16,19,22]])})))()},processResultClass:function(e){return e?"success":"failure"},tailErrLog:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={offset:0,length:1e4},t.next=3,p(e,n);case 3:if(r=t.sent,!r.result){t.next=6;break}return t.abrupt("return",r.result.log);case 6:case"end":return t.stop()}}),t)})))()},tailOutLog:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={offset:0,length:1e4},t.next=3,m(e,n);case 3:if(r=t.sent,!r.result){t.next=6;break}return t.abrupt("return",r.result.log);case 6:case"end":return t.stop()}}),t)})))()}}},g=f,h=(n("c6a2"),n("2877")),v=Object(h["a"])(g,r,a,!1,null,null,null);t["a"]=v.exports},"4ec9":function(e,t,n){"use strict";var r=n("6d61"),a=n("6566");e.exports=r("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),a,!0)},"515c":function(e,t,n){},"77e91":function(e,t,n){"use strict";n("4160"),n("c975"),n("ac1f"),n("1276"),n("159b");var r=n("b775"),a=n("51be"),i=a["a"],s={validCode:{url:i+"/api/topic/uniqueCheck",method:"get"},applicant:{url:i+"/api/userinfo/queryApplicants",method:"get"},getTopicsByClusterId:{url:i+"/api/topic/getTopicsByClusterId",method:"get"},getTopicsByCluster:{url:i+"/api/topic/getTopicsByCluster",method:"get"}},c={list:{url:i+"/api/env/listEnvironment",method:"get"}},o={list:{url:i+"/api/service/listClusters",method:"get"}},u={list:{url:i+"/api/consumer/queryApprovedConsumers",method:"get"},getApproveTopicList:{url:i+"/api/topic/getTopicsByClusterId",method:"get"},getConsumersByClusterId:{url:i+"/api/consumer/getConsumersByClusterId",method:"get"},validCode:{url:i+"/api/consumer/uniqueCheck",method:"post"}},l={theme:s,cluster:o,consumer:u,environment:c};function d(e){if(-1===e.indexOf("_"))return l[e];var t=l;return e.split("_").forEach((function(e){t=t[e]})),t}t["a"]={accessAPI:function(e){var t=e.apiUrl,n=void 0===t?"":t,a=e.params,i=void 0===a?{}:a,s=e.headers,c=void 0===s?{}:s,o={headers:c},u=d(n);return Object.assign(o,{url:u.url,method:u.method}),"get"===u.method?Object.assign(o,{params:i}):"post"!==u.method&&"put"!==u.method&&"patch"!==u.method&&"delete"!==u.method||Object.assign(o,{data:i}),Object(r["a"])(o)}}},c6a2:function(e,t,n){"use strict";var r=n("515c"),a=n.n(r);a.a},e350:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));n("caad"),n("45fc"),n("2532");var r=n("4360"),a=function(e){if(e&&e instanceof Array&&e.length>0){var t=r["a"].getters&&r["a"].getters.permissions,n=e,a=t.some((function(e){return n.includes(e)}));return!!a}return console.error("need roles! Like v-if=\"checkPerm['op_editor']\""),!1},i=function(e){var t=r["a"].getters.userInfo.realName;return e===t}}}]);